import { defineConfig } from '@ice/app';
import type { UserConfig } from '@ice/app';
import compatRax from '@ice/plugin-rax-compat';

const config: UserConfig = <%-JSON.stringify(iceConfig)%>

// TODO: Delete bundle and format, there is currently a problem with ems packaging.
if (!config.server) {
  config.server = {};
}
config.server.bundle = true;
config.server.format = 'cjs';

if (!config.plugins) {
  config.plugins = [];
}
config.plugins.push(compatRax(<%-JSON.stringify(compatRaxConfig)%>));

// The project config, see https://v3.ice.work/docs/guide/basic/config
export default defineConfig(config);
